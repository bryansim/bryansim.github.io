<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<base href="https://bryansim.github.io/">
<meta name="description" content="This is my blog!">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Bryan Sim</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://bryansim.github.io/">
<link rel="icon" href="http://bryans.im/favicon.ico" sizes="16x16">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/mousetracker-data-1/" type="text/html">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://bryansim.github.io/">

                <span id="blog-title">Bryan Sim</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="categories/mediocre-museum">Mediocre Museum</a>
                </li>
<li>
<a href="categories/mousetracker">Mousetracker</a>
                </li>
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="http://linkedin.com/in/bryansim">LinkedIn</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    
<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/mousetracker-data-1/" class="u-url">Mousetracker Data #1</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Bryan Sim
            </span></p>
            <p class="dateline"><a href="posts/mousetracker-data-1/" rel="bookmark"><time class="published dt-published" datetime="2016-05-02T15:24:22-04:00" title="2016-05-02 15:24">2016-05-02 15:24</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Overview">Overview<a class="anchor-link" href="posts/mousetracker-data-1/#Overview">¶</a>
</h2>
<p>I'm going to be looking at some pilot data that some colleagues and I collected using Jon Freeman's Mousetracker (<a href="http://www.mousetracker.org/">http://www.mousetracker.org/</a>). As the name suggests, mousetracker is a program designed to track participants' mouse movements. In social psychology, researchers use it to track participants' implicit decision making processes. Originally, it was developed to study how individuals categorize faces. An example of the paradigm would be a participant having to choose whether a face is male or female, like so: <img src="http://static1.squarespace.com/static/54612594e4b09fab6f870891/546efb6ae4b0923225b792c7/546efb6ce4b0a19016ccac11/1416559468408/p.jpg?format=2500w" alt="mousetracker image here"></p>
<p>The researcher could then vary the degree to which the face has stereotypically male features, or stereotypically female features, and track not just <em>what</em> participants are categorizing the faces as, but also, <em>how</em> they reach those decisions, by tracking the paths and time course of the mouse movements.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Current-project">Current project<a class="anchor-link" href="posts/mousetracker-data-1/#Current-project">¶</a>
</h2>
<p>Anyway, some friends and I are currently working on distinguishing how individuals allocate resources in the context of a relationship. We hypothesize that at any given time, individuals are concerned with:</p>
<ol>
<li>their self-interest</li>
<li>their partner's interests</li>
<li>the interest of the <em>group</em> or dyad, or the relationship, or them as a pair</li>
</ol>
<p>and these motives affect the way individuals choose to distribute resources. To distinguish between these three motives, we generated three sets of stimuli using poker chips that pit each of these motives against each other.</p>
<p>The first set of stimuli pit participants' self-interest against the interests of their partner. For example, if red poker chips were paid out to you and green to your partner, one dilemma would be choosing between these two stacks of poker chips of equal height (i.e., the group receives the same in both cases):</p>
<table>
<thead><tr>
<th style="text-align:center">Left</th>
<th style="text-align:center">Right</th>
</tr></thead>
<tbody><tr>
<td style="text-align:center"><img src="https://raw.githubusercontent.com/bryansim/Python/master/mousetrackerdata/so1.jpg" alt="so1"></td>
<td style="text-align:center"><img src="https://raw.githubusercontent.com/bryansim/Python/master/mousetrackerdata/so2.jpg" alt="so2"></td>
</tr></tbody>
</table>
<p>The second set of stimuli pits a participant's concern for the interest of their partner vs. their own self interest and the group's interest. This captures participants' "pure" altruistic motives in the sense that choosing to favor their partner in this scenario sacrifices both their own interests and the group's interest:</p>
<table>
<thead><tr>
<th style="text-align:center">Left</th>
<th style="text-align:center">Right</th>
</tr></thead>
<tbody><tr>
<td style="text-align:center"> <img src="https://raw.githubusercontent.com/bryansim/Python/master/mousetrackerdata/smgm1.jpg" alt="smgm1">
</td>
<td style="text-align:center"><img src="https://raw.githubusercontent.com/bryansim/Python/master/mousetrackerdata/smgm2.jpg" alt="smgm2"></td>
</tr></tbody>
</table>
<p>Finally, the last set of stimuli pit participants' self-interest against that of their partner and the group. In this case, one set of poker chips results in the participant getting more than the other set of chips, but in the other set of poker chips, his/her partner gets more <em>and</em> so does the pair of them:</p>
<table>
<thead><tr>
<th style="text-align:center">Left</th>
<th style="text-align:center">Right</th>
</tr></thead>
<tbody><tr>
<td style="text-align:center"> <img src="https://raw.githubusercontent.com/bryansim/Python/master/mousetrackerdata/slgm1.jpg" alt="slgm1">
</td>
<td style="text-align:center"><img src="https://raw.githubusercontent.com/bryansim/Python/master/mousetrackerdata/slgm2.jpg" alt="slgm2"></td>
</tr></tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-data">The data<a class="anchor-link" href="posts/mousetracker-data-1/#The-data">¶</a>
</h2>
<p>The data come in a person-period dataset. This is a "long" format where each participant has multiple rows that represent each trial of the experiment (there were 60 or so trials). However, each row also contains multiple columns each representing a bin of average locations the participant's mouse pointer was during that time span. There are ~100 such bins.</p>
<p>In other words, each participant made 60 choices, and their mouse positions were averaged into ~100 time points per trial.</p>
<p>The first thing we're going to do is to load our data. To do this, we first import Pandas, read our .csv file and print a list of columns. The raw data can be found here: <a href="https://raw.githubusercontent.com/bryansim/Python/master/mousetrackerdata/mousetrackercorrected.csv">https://raw.githubusercontent.com/bryansim/Python/master/mousetrackerdata/mousetrackercorrected.csv</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">re</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"mousetrackercorrected.csv"</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[2]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array(['subject', 'trial', 'stimfile', 'condition', 'code', 'resp_1',
       'resp_2', 'response', 'distractor', 'error', 'init time', 'RT',
       'MD_1', 'MD_2', 'AUC_1', 'AUC_2', 'MD_time', 'x-flip', 'y-flip',
       'z-MD-separate', 'z-MD-together', 'z-AUC-separate',
       'z-AUC-together', 'comments', 'X_1', 'X_2', 'X_3', 'X_4', 'X_5',
       'X_6', 'X_7', 'X_8', 'X_9', 'X_10', 'X_11', 'X_12', 'X_13', 'X_14',
       'X_15', 'X_16', 'X_17', 'X_18', 'X_19', 'X_20', 'X_21', 'X_22',
       'X_23', 'X_24', 'X_25', 'X_26', 'X_27', 'X_28', 'X_29', 'X_30',
       'X_31', 'X_32', 'X_33', 'X_34', 'X_35', 'X_36', 'X_37', 'X_38',
       'X_39', 'X_40', 'X_41', 'X_42', 'X_43', 'X_44', 'X_45', 'X_46',
       'X_47', 'X_48', 'X_49', 'X_50', 'X_51', 'X_52', 'X_53', 'X_54',
       'X_55', 'X_56', 'X_57', 'X_58', 'X_59', 'X_60', 'X_61', 'X_62',
       'X_63', 'X_64', 'X_65', 'X_66', 'X_67', 'X_68', 'X_69', 'X_70',
       'X_71', 'X_72', 'X_73', 'X_74', 'X_75', 'X_76', 'X_77', 'X_78',
       'X_79', 'X_80', 'X_81', 'X_82', 'X_83', 'X_84', 'X_85', 'X_86',
       'X_87', 'X_88', 'X_89', 'X_90', 'X_91', 'X_92', 'X_93', 'X_94',
       'X_95', 'X_96', 'X_97', 'X_98', 'X_99', 'X_100', 'X_101', 'Y_1',
       'Y_2', 'Y_3', 'Y_4', 'Y_5', 'Y_6', 'Y_7', 'Y_8', 'Y_9', 'Y_10',
       'Y_11', 'Y_12', 'Y_13', 'Y_14', 'Y_15', 'Y_16', 'Y_17', 'Y_18',
       'Y_19', 'Y_20', 'Y_21', 'Y_22', 'Y_23', 'Y_24', 'Y_25', 'Y_26',
       'Y_27', 'Y_28', 'Y_29', 'Y_30', 'Y_31', 'Y_32', 'Y_33', 'Y_34',
       'Y_35', 'Y_36', 'Y_37', 'Y_38', 'Y_39', 'Y_40', 'Y_41', 'Y_42',
       'Y_43', 'Y_44', 'Y_45', 'Y_46', 'Y_47', 'Y_48', 'Y_49', 'Y_50',
       'Y_51', 'Y_52', 'Y_53', 'Y_54', 'Y_55', 'Y_56', 'Y_57', 'Y_58',
       'Y_59', 'Y_60', 'Y_61', 'Y_62', 'Y_63', 'Y_64', 'Y_65', 'Y_66',
       'Y_67', 'Y_68', 'Y_69', 'Y_70', 'Y_71', 'Y_72', 'Y_73', 'Y_74',
       'Y_75', 'Y_76', 'Y_77', 'Y_78', 'Y_79', 'Y_80', 'Y_81', 'Y_82',
       'Y_83', 'Y_84', 'Y_85', 'Y_86', 'Y_87', 'Y_88', 'Y_89', 'Y_90',
       'Y_91', 'Y_92', 'Y_93', 'Y_94', 'Y_95', 'Y_96', 'Y_97', 'Y_98',
       'Y_99', 'Y_100', 'Y_101'], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">19</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[3]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>subject</th>
      <th>trial</th>
      <th>stimfile</th>
      <th>condition</th>
      <th>code</th>
      <th>resp_1</th>
      <th>resp_2</th>
      <th>response</th>
      <th>distractor</th>
      <th>error</th>
      <th>init time</th>
      <th>RT</th>
      <th>MD_1</th>
      <th>MD_2</th>
      <th>AUC_1</th>
      <th>AUC_2</th>
      <th>MD_time</th>
      <th>x-flip</th>
      <th>y-flip</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>455806</td>
      <td>1</td>
      <td>NaN</td>
      <td>777</td>
      <td>prac2</td>
      <td>~S3_O6.jpg</td>
      <td>~S7_O8.jpg</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>256</td>
      <td>1197</td>
      <td>NaN</td>
      <td>0.0922</td>
      <td>NaN</td>
      <td>0.0755</td>
      <td>317</td>
      <td>8</td>
      <td>0</td>
    </tr>
<tr>
<th>1</th>
      <td>455806</td>
      <td>3</td>
      <td>NaN</td>
      <td>777</td>
      <td>prac8</td>
      <td>~S5_O4.jpg</td>
      <td>~S10_O11.jpg</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>180</td>
      <td>1238</td>
      <td>NaN</td>
      <td>0.0213</td>
      <td>NaN</td>
      <td>0.0030</td>
      <td>268</td>
      <td>4</td>
      <td>0</td>
    </tr>
<tr>
<th>2</th>
      <td>455806</td>
      <td>5</td>
      <td>NaN</td>
      <td>777</td>
      <td>prac4</td>
      <td>~S5_O4.jpg</td>
      <td>~S8_O9.jpg</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>151</td>
      <td>858</td>
      <td>NaN</td>
      <td>-0.0386</td>
      <td>NaN</td>
      <td>-0.0139</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
    </tr>
<tr>
<th>3</th>
      <td>455806</td>
      <td>7</td>
      <td>NaN</td>
      <td>777</td>
      <td>prac5</td>
      <td>~S10_O9.jpg</td>
      <td>~S7_O8.jpg</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>151</td>
      <td>1104</td>
      <td>NaN</td>
      <td>0.8836</td>
      <td>NaN</td>
      <td>1.3726</td>
      <td>293</td>
      <td>6</td>
      <td>0</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Descriptives">Descriptives<a class="anchor-link" href="posts/mousetracker-data-1/#Descriptives">¶</a>
</h3>
<p>In the above data, what we're going to be first doing is finding the mean of participants' reaction time (RT), maximum deviation (MD), and aure under curve (AUC). The latter two measures are measures of how much participants were "attracted" to the other option despite selecting the option that they did.</p>
<p>There are two columns for each (e.g., MD_1 and MD_2 depending on which option participants chose). These end up being redundant with one another, and we'll have to combine them.</p>
<p>x-flips and y-flips, as their names suggest, measure the number of times participants' cursors flipped on the x and y axis.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To combine the two MD columns, we create a new column, find all the rows which have data in MD_1, and then fill in the rows which <em>don't</em> have data in MD_1 with the rows that have data in MD_2. We do the same with AUC.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">'MD'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'MD_1'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">False</span><span class="p">,</span> <span class="p">[</span><span class="s1">'MD_1'</span><span class="p">]]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'MD'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,[</span><span class="s1">'MD'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'MD_2'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">False</span><span class="p">][</span><span class="s1">'MD_2'</span><span class="p">]</span> 
<span class="c1">#We do this to get a slice instead of data.loc[data['MD_2'].isnull() == False, ['MD_2']] which returns a dataframe</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">'AUC'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'AUC_1'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">False</span><span class="p">,</span> <span class="p">[</span><span class="s1">'AUC_1'</span><span class="p">]]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'AUC'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="p">[</span><span class="s1">'AUC'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'AUC_2'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">False</span><span class="p">][</span><span class="s1">'AUC_2'</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Mean-MD-and-AUC">Mean MD and AUC<a class="anchor-link" href="posts/mousetracker-data-1/#Mean-MD-and-AUC">¶</a>
</h4>
<p>Now, we can use the .mean() method to get the mean of the above.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">'AUC'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[6]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>0.4573244198895028</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">'MD'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[7]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>0.26286099447513805</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Means-by-choice-type">Means by choice type<a class="anchor-link" href="posts/mousetracker-data-1/#Means-by-choice-type">¶</a>
</h4>
<p>The next thing we want to do is see whether participants differed depending on what the type of choice was (e.g., self vs. other etc.) Eventually, we will have a 3x2 table of means:</p>
<table>
<thead><tr>
<th style="text-align:right">self vs. other</th>
<th style="text-align:center">group more w/ self less</th>
<th style="text-align:center">group more w/ self more</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right">chose selfish</td>
<td style="text-align:center">chose selfish</td>
<td style="text-align:center">chose selfish </td>
</tr>
<tr>
<td style="text-align:right">chose selfless</td>
<td style="text-align:center">chose selfless</td>
<td style="text-align:center">chose selffless </td>
</tr>
</tbody>
</table>
<p>Because of the way the conditions were coded (they include trial numbers), we'll use some regex to ignore those numbers:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">sodata</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'code'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">r'(so)'</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">False</span><span class="p">]</span>
<span class="n">smgldata</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'code'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">r'(smgl)'</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">False</span><span class="p">]</span>
<span class="n">smgmdata</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'code'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">r'(smgm)'</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">False</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="n">sodata</span><span class="p">[</span><span class="s1">'MD'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">smgldata</span><span class="p">[</span><span class="s1">'MD'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">smgmdata</span><span class="p">[</span><span class="s1">'MD'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>0.287940806045
0.240009049774
0.241194845361
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="n">sodata</span><span class="p">[</span><span class="s1">'AUC'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">smgldata</span><span class="p">[</span><span class="s1">'AUC'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">smgmdata</span><span class="p">[</span><span class="s1">'AUC'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>0.487281360202
0.4192239819
0.451306185567
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>AS IT TURNS OUT, this isn't very helpful, because this analysis collapses over whether or not participant chose the selfish or unselfish option, which is really what we're interested in. So let's look at that next:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="n">sodata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sodata</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">'MD'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">sodata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sodata</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">'MD'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">smgldata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">smgldata</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">'MD'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">smgldata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">smgldata</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">'MD'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">smgmdata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">smgmdata</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">'MD'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">smgmdata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">smgmdata</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">'MD'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>0.283236649215
0.292302427184
0.225892405063
0.247862676056
0.181802877698
0.391294545455
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="n">sodata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sodata</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">'AUC'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">sodata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sodata</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">'AUC'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">smgldata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">smgldata</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">'AUC'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">smgldata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">smgldata</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">'AUC'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">smgmdata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">smgmdata</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">'AUC'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="n">smgmdata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">smgmdata</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">'AUC'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>0.511068062827
0.465226699029
0.499286075949
0.374682394366
0.314955395683
0.795901818182
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, that table above looks like this:</p>
<table>
<thead><tr>
<th style="text-align:right">MD</th>
<th style="text-align:center">self vs. other</th>
<th style="text-align:center">group more w/ self less</th>
<th style="text-align:center">group more w/ self more</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right">chose selfish</td>
<td style="text-align:center">.28</td>
<td style="text-align:center">.23</td>
<td style="text-align:center">.18</td>
</tr>
<tr>
<td style="text-align:right">chose selfless</td>
<td style="text-align:center">.29</td>
<td style="text-align:center">.25</td>
<td style="text-align:center">.39</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:right">MD</th>
<th style="text-align:center">self vs. other</th>
<th style="text-align:center">group more w/ self less</th>
<th style="text-align:center">group more w/ self more</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right">chose selfish</td>
<td style="text-align:center">.51</td>
<td style="text-align:center">.50</td>
<td style="text-align:center">.31</td>
</tr>
<tr>
<td style="text-align:right">chose selfless</td>
<td style="text-align:center">.46</td>
<td style="text-align:center">.37</td>
<td style="text-align:center">.80</td>
</tr>
</tbody>
</table>
<p>Note to self: I need to check if I have the selfish vs. selfless options coded correctly. I believe error == 0 = selfish.</p>

</div>
</div>
</div>
    </div>
  </div>

    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/the-average-thing/" class="u-url">The Average Thing #1</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Bryan Sim
            </span></p>
            <p class="dateline"><a href="posts/the-average-thing/" rel="bookmark"><time class="published dt-published" datetime="2016-05-01T23:05:33-04:00" title="2016-05-01 23:05">2016-05-01 23:05</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Average-Thing">The Average Thing<a class="anchor-link" href="posts/the-average-thing/#The-Average-Thing">¶</a>
</h2>
<p>The Canada Science and Technology Museums Corporation hosts a repository of all the artifacts in its collection here: (<a href="http://techno-science.ca/en/data.php">http://techno-science.ca/en/data.php</a>). Let's do something interesting with it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Reading-and-cleaning-data">Reading and cleaning data<a class="anchor-link" href="posts/the-average-thing/#Reading-and-cleaning-data">¶</a>
</h3>
<p>The data come in either a .csv or .xml format. Let's first try reading the .csv file, because Pandas has native support for that. First, we import all the packages that we might need (e.g., regex), and tell Pandas not to truncate the columns like it usually does.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">"display.max_columns"</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">"display.max_columns"</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we import the data to a datafram named "data", using Pandas' built-in method .read_csv, specifying the delimiter "|", and telling it not to break when it comes across a bad line, but instead show a bunch of warnings and still continue.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"cstmc-CSV-en.csv"</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">"|"</span><span class="p">,</span> <span class="n">error_bad_lines</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">warn_bad_lines</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you turn the warnings on, it looks like some of the rows of the csv file have extra columns (i.e., they have 37 columns when we only have 36 column names. Because there are multiple missing values, it's not possible to determine what the extra columns represent. Just by eyeballing things, it looks like about ~500 of the 100,000 cases are problematic.</p>
<p>Our two options are to either ignore these cases, or try and read the xml file, which may or may not pay off. My recommendation is that we just move forward and try and get some initial analysis done before backtracking later if we want to.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here are the first 3 artifacts in the data:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[15]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>artifactNumber</th>
      <th>ObjectName</th>
      <th>GeneralDescription</th>
      <th>model</th>
      <th>SerialNumber</th>
      <th>Manufacturer</th>
      <th>ManuCountry</th>
      <th>ManuProvince</th>
      <th>ManuCity</th>
      <th>BeginDate</th>
      <th>EndDate</th>
      <th>date_qualifier</th>
      <th>patent</th>
      <th>NumberOfComponents</th>
      <th>ArtifactFinish</th>
      <th>ContextCanada</th>
      <th>ContextFunction</th>
      <th>ContextTechnical</th>
      <th>group1</th>
      <th>category1</th>
      <th>subcategory1</th>
      <th>group2</th>
      <th>category2</th>
      <th>subcategory2</th>
      <th>group3</th>
      <th>category3</th>
      <th>subcategory3</th>
      <th>material</th>
      <th>Length</th>
      <th>Width</th>
      <th>Height</th>
      <th>Thickness</th>
      <th>Weight</th>
      <th>Diameter</th>
      <th>image</th>
      <th>thumbnail</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>1966.0001.001</td>
      <td>Cover</td>
      <td>PAPER</td>
      <td>WESTERN CANADA AIRWAYS LTD.</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1927</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>AT THE TIME IT WAS THE WORLD'S MOST NORTHERNLY...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Aviation</td>
      <td>Commemorative</td>
      <td>Stamps &amp; coins</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>paper</td>
      <td>4.5 cm</td>
      <td>2.6 cm</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
    </tr>
<tr>
<th>1</th>
      <td>1966.0002.001</td>
      <td>Stamp, postage</td>
      <td>PAPER</td>
      <td>WESTERN CANADA AIRWAYS LTD.</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1927</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>PINK &amp; BLACK ON WHITE</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Aviation</td>
      <td>Commemorative</td>
      <td>Stamps &amp; coins</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>paper</td>
      <td>3.8 cm</td>
      <td>2.7 cm</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
    </tr>
<tr>
<th>2</th>
      <td>1966.0003.001</td>
      <td>Stamp, postage</td>
      <td>PAPER</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1932</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>DARK &amp; PALE BLUE ON WHITE</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Aviation</td>
      <td>Commemorative</td>
      <td>Stamps &amp; coins</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>paper</td>
      <td>12.8 cm</td>
      <td>8.4 cm</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And here are some cases which have too many columns:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">debug</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"cstmc-CSV-en.csv"</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">"|"</span><span class="p">,</span> <span class="n">error_bad_lines</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">skiprows</span> <span class="o">=</span> <span class="mi">37899</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">debug</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[9]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>1984.1214.001</td>
      <td>Engine, airplane</td>
      <td>NaN</td>
      <td>LTC1K-4A/LYCOMING T53</td>
      <td>LE09281X</td>
      <td>Avco Lycoming Div.</td>
      <td>United States of America</td>
      <td>Connecticut</td>
      <td>Stratford</td>
      <td>1969</td>
      <td>NaN</td>
      <td>circa</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Converts heat into mechanical power</td>
      <td>NaN</td>
      <td>Aviation</td>
      <td>Motive power</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
    </tr>
<tr>
<th>1</th>
      <td>1984.1215.001</td>
      <td>Engine, airplane</td>
      <td>NaN</td>
      <td>LTC1K-4A/LYCOMING T53</td>
      <td>LE09285X</td>
      <td>Avco Lycoming Div.</td>
      <td>United States of America</td>
      <td>Connecticut</td>
      <td>Stratford</td>
      <td>1969</td>
      <td>NaN</td>
      <td>circa</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Converts heat into mechanical power</td>
      <td>NaN</td>
      <td>Aviation</td>
      <td>Motive power</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
    </tr>
<tr>
<th>2</th>
      <td>1984.1216.001</td>
      <td>Propeller</td>
      <td>Glass - Fibre</td>
      <td>HAMILTON STANDARD</td>
      <td>337-339-330-325</td>
      <td>Hamilton Standard Propeller Div., United Aircr...</td>
      <td>United States of America</td>
      <td>Connecticut</td>
      <td>East hartford</td>
      <td>1969</td>
      <td>NaN</td>
      <td>circa</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Aircraft propeller</td>
      <td>NaN</td>
      <td>Aviation</td>
      <td>Aircraft parts</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>glass;fibre</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Recoding-dimensions-into-actual-units">Recoding dimensions into actual units<a class="anchor-link" href="posts/the-average-thing/#Recoding-dimensions-into-actual-units">¶</a>
</h3>
<p>The first thing we're going to do is to do convert all the dimensions, which have mixed units (e.g., 16cm and 10m or whatever) into one common unit. To do this, we're going to use regular expressions and loop through the dimension columns.</p>
<p>The other thing that we might want to do is decide what artifacts to actually use. It looks like some of the artifacts are things like documents and paper, and others are really big things like engines.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Dealing-with-missing-data">Dealing with missing data<a class="anchor-link" href="posts/the-average-thing/#Dealing-with-missing-data">¶</a>
</h4>
<p>As you can see from the example cases above, lots of data is missing or unavailable, which is probably to be expected given that not all columns are necessarily relevant to each artifact. However, this forces us to make a decision when trying to summarize data: How do we decide whether to include or exclude artifacts?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For example, the code below subsets data depending on whether or not any of the measurements of their physical dimensions (weight, height, etc.) are missing:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">datasub1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">'Length'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">False</span><span class="p">]</span>
<span class="n">datasub2</span> <span class="o">=</span> <span class="n">datasub1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datasub1</span><span class="p">[</span><span class="s1">'Width'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">False</span><span class="p">]</span>
<span class="n">datasub3</span> <span class="o">=</span> <span class="n">datasub2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datasub2</span><span class="p">[</span><span class="s1">'Height'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">False</span><span class="p">]</span>
<span class="n">datasub4</span> <span class="o">=</span> <span class="n">datasub3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datasub3</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">False</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Running the code below will list the problem cases with our regex - some have typos in them, others have European style decimal places (thanks Canada!)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">subdata</span> <span class="o">=</span> <span class="n">datasub3</span>
<span class="n">subdata</span> <span class="o">=</span> <span class="n">subdata</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">badlines</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">subdata</span><span class="p">[</span><span class="s1">'Length'</span><span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">r'(\d*\.\d*) .*'</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">badlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subdata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="s1">'Length'</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">x</span> <span class="o">+=</span><span class="mi">1</span>

<span class="k">print</span> <span class="n">badlines</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>['610 cm', '12 cm', '210 cm', '254,9 cm', '12,7 cm', '12,7 cm', '71.0\t cm', '81.0\t cm', '61,5 cm', '61,5 cm', '61,5 cm', '61,5 cm', '42.3\t cm', '59,5 cm', '58,0 cm', '176.O cm', '157,5 cm', '18,5 cm', '2,4 cm', '19,5 cm', '32,0 cm', ' cm', '21,0 cm', '30 cm', '58 cm', '5200 cm', '172,0 cm', '26.,0 cm', '26.,0 cm', '43,7 cm', '200,0 cm', '41,5 cm', '180,0 cm', '150 cm', '41,5 cm', '200 cm', '24 cm', '190 cm', '229 cm', '236 cm']
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's first sub out the commas for decimal places and remove the '\t' characters.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">subdata</span><span class="p">[</span><span class="s1">'Length'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">subdata</span><span class="p">[</span><span class="s1">'Length'</span><span class="p">]]</span>
<span class="n">subdata</span><span class="p">[</span><span class="s1">'Length'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">subdata</span><span class="p">[</span><span class="s1">'Length'</span><span class="p">]]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>AS IT HAPPENS, you can achieve the above using Pandas' built-in string methods, because I am a moron. Below, we use these methods on the "Length" dimension to replace the commas, extract the digits, extract the units, and then replace the units with the numbers to multiply the digits by (i.e., cm = 1, m = 100).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">artifactlengths</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Length'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">r'(\d*.\d*)'</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">artifactlengths</span> <span class="o">=</span> <span class="n">artifactlengths</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">)</span>
<span class="n">artifactlengthmultipliers</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Length'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">r'.* ([a-zA-Z]*)'</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Doing this, we've created a vector (i.e., a Pandas series) of floats, and a separate vector of strings that have the units. For the next step, we want to first replace cm and CM with 1, and m and M with 100, and look for the person who used inches and shoot them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">artifactlengthmultipliers</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[34]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array(['cm', nan, 'M', 'in', 'CM', 'm'], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We create a dictionary to use with the .replace method:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">unitreplacement</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"cm"</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="s2">"CM"</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">"m"</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">"M"</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">"in"</span> <span class="p">:</span> <span class="mf">2.54</span><span class="p">,</span>
    <span class="s2">"kg"</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">"KG"</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">"gm"</span> <span class="p">:</span> <span class="o">.</span><span class="mo">001</span><span class="p">,</span>
    <span class="s2">"tons"</span> <span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">"lbs"</span> <span class="p">:</span> <span class="o">.</span><span class="mi">453</span>
<span class="p">}</span>
<span class="n">artifactlengthmultipliersNUM</span> <span class="o">=</span> <span class="n">artifactlengthmultipliers</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">unitreplacement</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And then we multiple our numbers by our multipliers, and now we can use the data to find out the average length of all artifacts:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">#We have to coerce because our series contains missing values that cannot be typed</span>
<span class="n">artifactlengthincm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">artifactlengths</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="s1">'coerce'</span><span class="p">)</span> <span class="o">*</span> <span class="n">artifactlengthmultipliersNUM</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">artifactlengthincm</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[37]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>44.711496657068245</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Functions-to-extract-digits-and-units:">Functions to extract digits and units:<a class="anchor-link" href="posts/the-average-thing/#Functions-to-extract-digits-and-units:">¶</a>
</h4>
<p>Now that we've done this once with length, we can write some functions to do the above easily with the rest of the dimensions. We also have a function that will take a list of dimensions, and "numberize" all of them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">#These are the above as functions to run on our other dimensions</span>
<span class="k">def</span> <span class="nf">extract_digits</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="n">lengths</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">r'(\d*.\d*)'</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
    <span class="n">lengths</span> <span class="o">=</span> <span class="n">lengths</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">','</span> <span class="p">,</span> <span class="s1">'.'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">lengths</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="s1">'coerce'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">extract_multipliers</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="n">multipliers</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">r'.* ([a-zA-Z]*)'</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
    <span class="n">unitreplacement</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"cm"</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="s2">"CM"</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">"m"</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">"M"</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">"in"</span> <span class="p">:</span> <span class="mf">2.54</span><span class="p">,</span>
    <span class="s2">"kg"</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">"KG"</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">"gm"</span> <span class="p">:</span> <span class="o">.</span><span class="mo">001</span><span class="p">,</span>
    <span class="s2">"tons"</span> <span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">"lbs"</span> <span class="p">:</span> <span class="o">.</span><span class="mi">453</span>
    <span class="p">}</span>
    <span class="n">multipliers</span> <span class="o">=</span> <span class="n">multipliers</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">unitreplacement</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">multipliers</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="s1">'coerce'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">numberize_dimensions</span><span class="p">(</span><span class="n">listofdimensions</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">dimension</span> <span class="ow">in</span> <span class="n">listofdimensions</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">dimension</span> <span class="o">+</span> <span class="s2">"INT"</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_digits</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">dimension</span><span class="p">])</span>
        <span class="n">data</span><span class="p">[</span><span class="n">dimension</span> <span class="o">+</span> <span class="s2">"MULT"</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_multipliers</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">dimension</span><span class="p">])</span>
        <span class="n">data</span><span class="p">[</span><span class="n">dimension</span> <span class="o">+</span> <span class="s2">"NUM"</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">dimension</span> <span class="o">+</span> <span class="s2">"INT"</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="n">dimension</span> <span class="o">+</span> <span class="s2">"MULT"</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [126]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">#This was some hacky debugging when I manually did a binary search-type thing to find out which row numbers were messed up</span>
<span class="c1">#pd.to_numeric(artifactlengths[96050:96100])</span>
<span class="c1">#artifactlengths[96050:96100]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Rest-of-the-dimensions">Rest of the dimensions<a class="anchor-link" href="posts/the-average-thing/#Rest-of-the-dimensions">¶</a>
</h4>
<p>From the above, the average length of all the artifacts in the collection is 44.7cm. Let's find out what the average is for all the other dimensions:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">'HeightINT'</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_digits</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'Height'</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'HeightMULTI'</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_multipliers</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'Height'</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'HeightNUM'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'HeightINT'</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s1">'HeightMULTI'</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'HeightNUM'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[39]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>25.884008993874833</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The average height is 25.88cm</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">'WidthINT'</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_digits</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'Width'</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'WidthMULTI'</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_multipliers</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'Width'</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'WidthNUM'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'WidthINT'</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s1">'WidthMULTI'</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'WidthNUM'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[40]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>24.15538627441159</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The average width is 24.16 cm.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we work on weight. Given that the units for weights range from gm to tons, let's go with kg as the unit we'll use, and assume that tons refer to metric tons. There's also a 'cm' there. Something is wrong.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">'.* (.*)'</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[42]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([nan, 'kg', 'cm', 'tons', 'gm', 'lb'], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below, we extract the indices of cases with "cm" in the weight. There are 13 cases, and some of them look like a misalignment of the columns, but it's impossible to tell which way they are misaligned.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">cmtest</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">'(.* cm)'</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="c1">#Here are three</span>
<span class="n">data</span><span class="p">[</span><span class="n">cmtest</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">False</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[20]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>artifactNumber</th>
      <th>ObjectName</th>
      <th>GeneralDescription</th>
      <th>model</th>
      <th>SerialNumber</th>
      <th>Manufacturer</th>
      <th>ManuCountry</th>
      <th>ManuProvince</th>
      <th>ManuCity</th>
      <th>BeginDate</th>
      <th>EndDate</th>
      <th>date_qualifier</th>
      <th>patent</th>
      <th>NumberOfComponents</th>
      <th>ArtifactFinish</th>
      <th>ContextCanada</th>
      <th>ContextFunction</th>
      <th>ContextTechnical</th>
      <th>group1</th>
      <th>category1</th>
      <th>subcategory1</th>
      <th>group2</th>
      <th>category2</th>
      <th>subcategory2</th>
      <th>group3</th>
      <th>category3</th>
      <th>subcategory3</th>
      <th>material</th>
      <th>Length</th>
      <th>Width</th>
      <th>Height</th>
      <th>Thickness</th>
      <th>Weight</th>
      <th>Diameter</th>
      <th>image</th>
      <th>thumbnail</th>
    </tr></thead>
<tbody>
<tr>
<th>1934</th>
      <td>1966.0971.001</td>
      <td>Photograph</td>
      <td>photograph paper; wood frame; glass; paper &amp; c...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>JARMAN, FRANK LTD.</td>
      <td>Canada</td>
      <td>Ontario</td>
      <td>Ottawa</td>
      <td>1941</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>b + w photograph; black frame</td>
      <td>presented by Frank Learman to Ralph Bell, Dire...</td>
      <td>display</td>
      <td>NaN</td>
      <td>Aviation</td>
      <td>Archives</td>
      <td>Aircraft</td>
      <td>Aviation</td>
      <td>Archives</td>
      <td>Personal</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>paper-&gt;cardboard;wood-&gt;;glass-&gt;;metal-&gt;steel</td>
      <td>49.8 cm</td>
      <td>38.8 cm</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.9 cm</td>
      <td>NaN</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
    </tr>
<tr>
<th>1941</th>
      <td>1966.0978.001</td>
      <td>Photograph</td>
      <td>photograph paper; glass; plastic frame; steel ...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Royal Canadian Air Force</td>
      <td>Canada</td>
      <td>Ontario</td>
      <td>Ottawa</td>
      <td>1927</td>
      <td>NaN</td>
      <td>circa</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>b + w photograph; caption in white ink; mounte...</td>
      <td>RCAF Station Ottawa (later Rockcliffe) was the...</td>
      <td>taken as part of aerial photography survey for...</td>
      <td>NaN</td>
      <td>Aviation</td>
      <td>Archives</td>
      <td>Airport operations</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>paper-&gt;;glass-&gt;;synthetic-&gt;plastic;metal-&gt;steel</td>
      <td>45.3 cm</td>
      <td>40.0 cm</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.3 cm</td>
      <td>NaN</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
    </tr>
<tr>
<th>52400</th>
      <td>1989.0488.001</td>
      <td>Calculator, air navigation</td>
      <td>plastic; metal swivel at centre - possibly alu...</td>
      <td>B-24D</td>
      <td>NaN</td>
      <td>Consolidated Aircraft Corp.</td>
      <td>United States of America</td>
      <td>California</td>
      <td>San diego</td>
      <td>1941</td>
      <td>NaN</td>
      <td>after</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>white with black detail; pale yellow rotating ...</td>
      <td>NaN</td>
      <td>used to determine gross weight &amp; fore &amp; aft ce...</td>
      <td>especially useful on bombers because of varyin...</td>
      <td>Aviation</td>
      <td>Navigation instruments &amp; equipment</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>synthetic-&gt;plastic;metal-&gt;aluminum - possible</td>
      <td>28.0 cm</td>
      <td>25.2 cm</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0 cm</td>
      <td>NaN</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
      <td>http://source.techno-science.ca/artifacts-arte...</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's set those cases to NaN, and just ignore them for now:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cmtest</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="bp">False</span><span class="p">,[</span><span class="s1">'Weight'</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">'WeightINT'</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_digits</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'WeightMULT'</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_multipliers</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'WeightNUM'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'WeightINT'</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s1">'WeightMULT'</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'WeightNUM'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[48]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>1058.8799535602088</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The average weight is 1 ton, which may be a problem if we want to fabricate this. This doesn't seem to jive with our findings for the measurements though, so we're going to take a closer look at that next.</p>

</div>
</div>
</div>
    </div>
  </div>

    </div>
    </article>
</div>





            <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script><script type="text/x-mathjax-config">
            MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
            </script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2016         <a href="mailto:bryan.sim@nyu.edu">Bryan Sim</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
